# Модуль 3, Урок 3: Циклы `for` и `while` в Dino 3D

**Цель урока:** понять, зачем в играх нужны циклы, научиться писать `for` и `while` и применить их в Dino 3D: подготовить бесконечный раннер (спавнер препятствий + повторяющиеся действия).

---

В раннере одно и то же повторяется постоянно: препятствия появляются снова и снова, очки растут, мир "едет".
Если всё делать руками — это быстро станет невозможным.

---

Сегодня мы научимся говорить коду: "повтори это N раз" и "повторяй, пока условие верно".
Это и есть **циклы**.

---

## Теория 1: Цикл `for` — "сделай N раз"

`for` используют, когда мы заранее знаем, **сколько раз** повторить действие.

Шаблон:

```csharp
for (int i = 0; i < 5; i++)
{
    Debug.Log(i);
}
```

- `int i = 0` — старт
- `i < 5` — условие продолжения
- `i++` — шаг (что делаем после каждого повторения)

---

```quiz
id: l2m3y3-q-for-count
kind: single
text: Сколько раз выполнится цикл: for (int i = 0; i < 3; i++)?
answers:
  - text: 3
    correct: true
  - text: 2
  - text: 4
```

---

## Пояснение

- `i` принимает значения 0, 1, 2 → всего 3 раза.

---

```quiz
id: l2m3y3-q-for-i-values
kind: multiple
text: Какие значения примет i в цикле: for (int i = 1; i <= 3; i++)?
answers:
  - text: 0
  - text: 1
    correct: true
  - text: 2
    correct: true
  - text: 3
    correct: true
  - text: 4
```

---

## Пояснение (i = 1..3)

- Стартуем с 1, продолжаем пока `i <= 3`, поэтому i = 1,2,3.

---

## Практика 1: Тренировка в коде — "счётчик спавна" (for)

Это отдельная тренировка **не в Dino 3D**, чтобы спокойно закрепить `for`.

### Часть 1: Проверка знаний (Quiz)

```quiz
id: l2m3y3-p1-q-for-purpose
kind: single
text: Когда удобнее всего использовать for?
answers:
  - text: Когда нужно повторить действие фиксированное число раз
    correct: true
  - text: Когда нужно выполнить действие один раз
  - text: Когда мы не знаем, сколько раз повторять
```

---

## Ответы: Практика 1 (Quiz)

- `for` — когда заранее знаем количество повторений.

---

```quiz
id: l2m3y3-p1-q-for-step
kind: single
text: Какая часть цикла отвечает за "шаг" (изменение i)?
answers:
  - text: int i = 0
  - text: i < 10
  - text: i++
    correct: true
```

---

## Ответы: Практика 1 (Quiz) — продолжение

- `i++` — это шаг, он выполняется после каждой итерации.
При каждом повторении мы говорим что увеличиваем на i на 1.

---

### Часть 2: Тренировка в коде

**Задача:**

1. Создайте скрипт `LoopCounterDemo.cs`.
2. В `Start()` запустите цикл `for`, который 5 раз выводит в консоль:
   - "Спавн препятствия №0", "№1", …, "№4"

Пример:

```csharp
using UnityEngine;

public class LoopCounterDemo : MonoBehaviour
{
    void Start()
    {
        for (int i = 0; i < 5; i++)
            Debug.Log("Спавн препятствия №" + i);
    }
}
```

```check
rules:
  - filename: "LoopCounterDemo.cs"
  - contains: "for ("
  - contains: "Debug.Log"
  - contains: "i < 5"
```

---

## Перерыв

---

В игре часто бывает иначе: мы не знаем, сколько раз повторять, но знаем условие "пока …".
Например: "пока игра не окончена", "пока таймер < 60".

---

## Теория 2: Цикл `while` — "повторяй, пока условие true"

`while` повторяет код, пока условие остаётся `true`.

Пример:

```csharp
int x = 0;
while (x < 3)
{
    Debug.Log(x);
    x++;
}
```

Важное правило: внутри `while` условие должно **меняться**, иначе получится бесконечный цикл.

---

```quiz
id: l2m3y3-q-while-when
kind: single
text: Когда выполняется тело while?
answers:
  - text: Пока условие true
    correct: true
  - text: Только один раз
  - text: Пока условие false
```

---

## Пояснение (while)

- `while` работает "пока true".

---

```quiz
id: l2m3y3-q-while-infinite
kind: single
text: Что случится, если в while условие никогда не станет false?
answers:
  - text: Цикл станет бесконечным и игра/редактор могут зависнуть
    correct: true
  - text: Unity автоматически остановит цикл через 1 секунду
  - text: Ничего, while всегда выполняется один раз
```

---

## Пояснение (бесконечный while)

- Важно менять переменную/условие внутри цикла.

---

## Практика 2: Применение в игре — спавнер препятствий

На этом уроке мы делаем основу "бесконечности": препятствия будут появляться сами, двигаться навстречу игроку и удаляться.

### Шаг 1: Подготовка префаба препятствия

1. Создайте `Obstacle` (Cube/любой примитив).
2. Добавьте `Collider`, включите `Is Trigger`.
3. Создайте скрипт `ObstacleTrigger.cs` и повесьте на `Obstacle`.
4. Пока при столкновении выводим `Debug.Log` (Game Over сделаем в 4-м уроке).
5. Сделайте `Prefab` `Obstacle.prefab` (перетащите в Project).

> Динозаврик сам бежит вправо (из урока 1), поэтому препятствия **не двигаются** — они просто стоят на месте, а игрок к ним подбегает. Чтобы сцена не засорялась старыми объектами, добавим `Destroy(gameObject, 10f)` — препятствие удалится через 10 секунд.

```csharp
using UnityEngine;

public class ObstacleTrigger : MonoBehaviour
{
    void Start()
    {
        Destroy(gameObject, 10f); // Авто-удаление через 10 секунд
    }

    void OnTriggerEnter(Collider other)
    {
        if (other.GetComponent<DinoController>())
            Debug.Log("Столкновение с препятствием!");
    }
}
```

```check
rules:
  - filename: "ObstacleTrigger.cs"
  - contains: "OnTriggerEnter"
  - contains: "GetComponent<DinoController>"
  - contains: "Destroy(gameObject"
```

---

### Шаг 2: Скрипт `ObstacleSpawner.cs` (таймер + повторение)

1. Создайте пустой объект `Spawner` и поставьте его **справа за экраном** (откуда появляются препятствия).
2. Создайте `ObstacleSpawner.cs` и повесьте на `Spawner`.
3. В `Update()` копите таймер и делайте `Instantiate`, когда пришло время.

```csharp
using UnityEngine;

public class ObstacleSpawner : MonoBehaviour
{
    public GameObject obstaclePrefab;
    public float spawnInterval = 1.5f;

    private float timer;

    void Update()
    {
        timer += Time.deltaTime;
        if (timer >= spawnInterval)
        {
            timer = 0f;
            Instantiate(obstaclePrefab, transform.position, Quaternion.identity);
        }
    }
}
```

```check
rules:
  - object_exists: "Spawner"
  - filename: "ObstacleSpawner.cs"
  - contains: "spawnInterval"
  - contains: "Time.deltaTime"
  - contains: "Instantiate"
```

---

### Шаг 3 (усложнение): "пачка препятствий" через `for`

Иногда хочется за раз создать несколько препятствий (например 2-3).

**Идея:**

```csharp
for (int i = 0; i < 3; i++)
    Instantiate(obstaclePrefab, transform.position + Vector3.right * i * 2f, Quaternion.identity);
```

---

## Итоги

На уроке мы:

- разобрали циклы `for` и `while` и научились читать их "по частям"
- сделали тренировки на повторение действий
- создали препятствие с триггером столкновения и авто-удалением
- собрали спавнер: препятствия появляются бесконечно с интервалом
